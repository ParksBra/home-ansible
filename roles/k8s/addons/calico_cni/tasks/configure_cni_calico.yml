- name: Create CNI directory
  ansible.builtin.file:
    path: "{{ k8s_cni_directory }}"
    state: directory

- name: Configure Calico CNI
  ansible.builtin.template:
    src: "calico.yml.j2"
    dest: "{{ k8s_cni_directory }}/calico.yml"

- name: Apply Calico CNI configuration
  ansible.builtin.command: "kubectl --kubeconfig={{ k8s_kubectl_config_path }} apply -f {{ k8s_cni_directory }}/calico.yml"
